<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>超级签名详细实现</title>
    <url>/2019/11/14/%E8%B6%85%E7%BA%A7%E7%AD%BE%E5%90%8D%E8%AF%A6%E7%BB%86%E5%AE%9E%E7%8E%B0/</url>
    <content><![CDATA[<p><img src="/2019/11/14/%E8%B6%85%E7%BA%A7%E7%AD%BE%E5%90%8D%E8%AF%A6%E7%BB%86%E5%AE%9E%E7%8E%B0/20191114_06.jpg" alt="20191114_06"></p>
<p>Because you have never seen the miracle. - 《银翼杀手2049》</p>
<h2 id="超级签名是什么？"><a href="#超级签名是什么？" class="headerlink" title="超级签名是什么？"></a>超级签名是什么？</h2><p>所谓的超级签名，其实一句话就能说清楚：使用了苹果提供给开发者的Ad-Hoc分发通道，把安装设备当做开发设备进行分发。</p>
<p>优势：直接分发，安装即可运行，不需要用户做企业证书的信任操作，不会有证书吊销导致的风险<br>劣势：成本昂贵，单开发者账号的iPhone设备数量只有100个，</p>
<a id="more"></a>

<h3 id="实现流程"><a href="#实现流程" class="headerlink" title="实现流程"></a>实现流程</h3><p><img src="/2019/11/14/%E8%B6%85%E7%BA%A7%E7%AD%BE%E5%90%8D%E8%AF%A6%E7%BB%86%E5%AE%9E%E7%8E%B0/20191114_05.jpg?40" alt></p>
<ol>
<li>手机安装<code>.mobileconf</code>文件，将UDID发给服务器</li>
<li>服务器将收到的UDID注册到苹果开发者账号中，并更新描述文件</li>
<li>将更新后的描述文件来重签App</li>
<li>最后将重签的App上传至cdn，利用<code>itms-services</code>方式做分发下载</li>
</ol>
<h3 id="详细实现细节"><a href="#详细实现细节" class="headerlink" title="详细实现细节"></a>详细实现细节</h3><ol>
<li><p>准备好获取UDID的配置文件，也就是<code>.mobileconf</code>文件，文件内容大致如下:</p>
 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadContent<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>URL<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">!–</span> 接收数据的接口地址 –&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>http://106.54.214.191:443/udid/receive<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>DeviceAttributes<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>UDID<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>IMEI<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>ICCID<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>VERSION<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>PRODUCT<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadOrganization<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>www.qianniuniu.com<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadDisplayName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>Test<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">integer</span>&gt;</span>1<span class="tag">&lt;/<span class="name">integer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadUUID<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>8C7AD0B8-3900-44DF-A52F-3C4F92921807<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadIdentifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>com.super.signature<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadDescription<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>该配置文件将帮助用户获取当前iOS设备的UDID号码。This temporary profile will be used to find and display your current device's UDID.<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>PayloadType<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>Profile Service<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用服务器https证书对配置文件签名</p>
</li>
</ol>
<p><img src="/2019/11/14/%E8%B6%85%E7%BA%A7%E7%AD%BE%E5%90%8D%E8%AF%A6%E7%BB%86%E5%AE%9E%E7%8E%B0/20191114_02.PNG" alt></p>
<ol start="3">
<li><p>当用户点击上图的右上角安装后，就会调用<code>http://106.54.214.191:443/udid/receive</code>这个地址，服务器端就会收到UDID等信息</p>
</li>
<li><p>利用开源工具Spaceship，注册新的开发者设备到苹果开发者中心，并更新 Provisioning Profile，服务器端使用的是 ruby 脚本来完成这个功能：</p>
 <figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/ruby -w</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">"spaceship"</span></span><br><span class="line"></span><br><span class="line">puts <span class="string">"======Hello, Write Start======"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先登录</span></span><br><span class="line">Spaceship::Portal.login(<span class="string">"1711218908@qq.com"</span>, <span class="string">"密码"</span>)</span><br><span class="line"></span><br><span class="line">is_bundle = Spaceship.app.find(<span class="string">"com.super01.signature"</span>)</span><br><span class="line"><span class="keyword">if</span> !is_bundle</span><br><span class="line">Spaceship.app.create!(bundle_id: <span class="string">"com.super01.signature"</span>, name: <span class="string">'iosudid'</span>)</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"><span class="comment">#group权限</span></span><br><span class="line">app = Spaceship::Portal.app.find(<span class="string">"com.super01.signature"</span>)</span><br><span class="line"></span><br><span class="line">group = Spaceship::Portal.app_group.find(<span class="string">"group.com.super01.signature"</span>)</span><br><span class="line"><span class="keyword">if</span> !group</span><br><span class="line">    group = Spaceship::Portal.app_group.create!(group_id: <span class="string">"group.com.super01.signature"</span>,name: <span class="string">"Another group"</span>)</span><br><span class="line">end</span><br><span class="line">app = app.associate_groups([group])</span><br><span class="line">app.update_service(Spaceship::Portal.app_service.network_extension.on)</span><br><span class="line">app.update_service(Spaceship::Portal.app_service.access_wifi.on)</span><br><span class="line">app.update_service(Spaceship::Portal.app_service.push_notification.on)</span><br><span class="line">app.update_service(Spaceship::Portal.app_service.game_center.on)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新增设备的UDID</span></span><br><span class="line">Spaceship::Portal.device.create!(name: <span class="string">"王方"</span>, udid: <span class="string">"7d7da5ba1d924d43b512c9ba9f976fdf47085209"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#更新设备</span></span><br><span class="line">allDevices = Spaceship.device.all</span><br><span class="line">device_profiles = Spaceship::Portal.provisioning_profile.ad_hoc.find_by_bundle_id(bundle_id: <span class="string">"com.super01.signature"</span>)</span><br><span class="line">device_profiles.each <span class="keyword">do</span> |profile|</span><br><span class="line">    profile.devices = allDevices</span><br><span class="line">    profile.update!</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"><span class="comment">#下载描述文件</span></span><br><span class="line">matching_profiles = Spaceship::Portal.provisioning_profile.ad_hoc.find_by_bundle_id(bundle_id: <span class="string">"com.super01.signature"</span>)</span><br><span class="line"><span class="keyword">if</span> matching_profiles.first</span><br><span class="line">File.write(<span class="string">"SuperSignatureAdHocProfile.mobileprovision"</span>, matching_profiles.first.download)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    cert = Spaceship::Portal.certificate.production.all.first</span><br><span class="line">    profile=Spaceship.provisioning_profile.ad_hoc.create!(bundle_id: <span class="string">"com.super01.signature"</span>, certificate: cert, name: <span class="string">"com.super01.signature adhoc"</span>)</span><br><span class="line">    File.write(<span class="string">"SuperSignatureAdHocProfile.mobileprovision"</span>, profile.download)</span><br><span class="line">end</span><br><span class="line">                        </span><br><span class="line">puts <span class="string">"====== Hello, Write End! ======"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>制作.cer证书，这一步和我们平时做iOS开发一样，我就不多说了</p>
</li>
<li><p>重点来了，ipa包的重签，这里使用的是 <a href="https://github.com/zhlynn/zsign" target="_blank" rel="noopener">zsign</a>，将步骤3中更新后的描述文件和步骤4中的证书放在zsign项目的同一级目录下，如下图：<br> <img src="/2019/11/14/%E8%B6%85%E7%BA%A7%E7%AD%BE%E5%90%8D%E8%AF%A6%E7%BB%86%E5%AE%9E%E7%8E%B0/20191114_01.PNG" alt></p>
<p> 使用命令如下：</p>
 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">./zsign -k key.p12 -p 123 -m SuperSignatureAdHocProfile.prov -o output.ipa SASpecs.app</span><br></pre></td></tr></table></figure>

<p> 将重签好的ipa包上传至cdn服务器，下一步制作分发文件。</p>
</li>
<li><p>分发文件（<code>manifest.plist</code>）需要准备两张图片的下载地址，文件内容如下：</p>
 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>items<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>assets<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">key</span>&gt;</span>kind<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">string</span>&gt;</span>software-package<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">key</span>&gt;</span>url<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">string</span>&gt;</span>https://qnnapk-1251122539.cos.ap-shanghai.myqcloud.com/SASpecs.ipa<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">key</span>&gt;</span>kind<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">string</span>&gt;</span>display-image<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">key</span>&gt;</span>url<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">string</span>&gt;</span>https://qnnapk-1251122539.cos.ap-shanghai.myqcloud.com/57.png<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">key</span>&gt;</span>kind<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">string</span>&gt;</span>full-size-image<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">key</span>&gt;</span>url<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">string</span>&gt;</span>https://qnnapk-1251122539.cos.ap-shanghai.myqcloud.com/512.png<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>metadata<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">key</span>&gt;</span>bundle-identifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>com.super.signature<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">key</span>&gt;</span>bundle-version<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">key</span>&gt;</span>kind<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>software<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">key</span>&gt;</span>platform-identifier<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>com.apple.platform.iphoneos<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">key</span>&gt;</span>title<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>SASpecs<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>当用户下载这个分发文件后就会安装对应的ipa包，</p>
</li>
</ol>
<p><img src="/2019/11/14/%E8%B6%85%E7%BA%A7%E7%AD%BE%E5%90%8D%E8%AF%A6%E7%BB%86%E5%AE%9E%E7%8E%B0/20191114_04.PNG" alt></p>
<h2 id="至此，大功告成"><a href="#至此，大功告成" class="headerlink" title="至此，大功告成"></a>至此，大功告成</h2>]]></content>
      <categories>
        <category>技术</category>
      </categories>
      <tags>
        <tag>超级签名</tag>
      </tags>
  </entry>
  <entry>
    <title>Next主题设置分类和标签</title>
    <url>/2019/11/13/next-theme-set-tags/</url>
    <content><![CDATA[<p>最近将Hexo的主题换成了Next，发现配置 <code>themes/next/_config.yml</code>后，点击分类或标签显示Cannot GET /tags/%20/的问题，查官方文档好像也没有具体说明，只能自己去一步一步试，也记录一下解决问题的过程：</p>
<p>使用 <code>hexo new page &quot;tags&quot;</code> 和 <code>hexo new page &quot;categories&quot;</code> 在source目录下生成对应的本地文件，</p>
<p>修改 <code>tags/index.md</code> 文件</p>
<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 分类</span><br><span class="line">date: 2019-11-13 17:15:12</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>修改 <code>categories/index.md</code> 文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2019-11-13 17:40:15</span><br><span class="line">type: &quot;categories&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>然后每次写的新文章顶部写入categories/tags的value值, hexo即可自动帮你进行分类或标签管理</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 加密解密</span><br><span class="line">date: 2019-02-21 20:38:37</span><br><span class="line">categories: 学习笔记</span><br><span class="line">tags: iOS</span><br><span class="line">---</span><br></pre></td></tr></table></figure>


<p>主题配置文件也别忘了打开以下注释，</p>
<p>注意：重点来了</p>
<blockquote>
<p><code>/||</code> 之间去掉空格<br><code>/||</code> 之间去掉空格<br><code>/||</code> 之间去掉空格</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: /|| home</span><br><span class="line">  #about: /about/ || user</span><br><span class="line">  tags: /tags/|| tags</span><br><span class="line">  categories: /categories/|| th</span><br><span class="line">  archives: /archives/|| archive</span><br><span class="line">  #schedule: /schedule/ || calendar</span><br><span class="line">  #sitemap: /sitemap.xml || sitemap</span><br><span class="line">  #commonweal: /404/ || heartbeat</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/13/next-theme-set-tags/20191112.png" alt="20191112"></p>
]]></content>
      <categories>
        <category>技术</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Flutter-UI-Develop</title>
    <url>/2019/08/25/Flutter-UI-Develop/</url>
    <content><![CDATA[<h2 id="跨平台开发方案的三个时代"><a href="#跨平台开发方案的三个时代" class="headerlink" title="跨平台开发方案的三个时代"></a>跨平台开发方案的三个时代</h2><p>Web容器时代:基于Web相关技术通过浏览器组件来实现界面及功能，典型的框架包括 Cordova(PhoneGap)、Ionic和微信小程序。<br>缺点：一个完整H5页面的展示要经历浏 览器控件的加载、解析和渲染三大过程，性能消耗要比原生开发增加N个数量级，内存占用多、网页加载速度慢、渲染慢、JavaScript 执行慢、交互体验差等</p><a id="more"></a>
<p>泛Web容器时代:采用类Web标准进行开发，但在运行时把绘制和渲染交由原生系统接管的技术，代表框 架有React Native、Weex和快应用，广义的还包括天猫的Virtual View等。<br>缺点：需要处理大量平台相关的逻辑外，随着系统版本变化和API的变化，我们还需要处理不同平台的原生 控件渲染能力差异，修复各类奇奇怪怪的Bug。</p>
<p>自绘引擎时代:自带渲染引擎，客户端仅提供一块画布即可获得从业务逻辑到功能呈现的多端高度一致的 渲染体验。Flutter，是为数不多的代表。</p>
<p>下面是跨平台开发方案的对比：</p>
<table>
<thead>
<tr>
<th>开发方案</th>
<th>Web容器</th>
<th>RN</th>
<th>Weex</th>
<th>Flutter</th>
</tr>
</thead>
<tbody><tr>
<td>类型</td>
<td>Web容器</td>
<td>泛Web容器</td>
<td>泛Web容器</td>
<td>自绘引擎</td>
</tr>
<tr>
<td>支持平台</td>
<td>Android/iOS/Web</td>
<td>Android/iOS</td>
<td>Android/iOS、Web</td>
<td>Android/iOS</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>开发语言</td>
<td>Javascript</td>
<td>Javascript(React)</td>
<td>Javascript(Vue)</td>
<td>Dart</td>
</tr>
<tr>
<td>技术栈</td>
<td>前端</td>
<td>偏前端</td>
<td>偏前端</td>
<td>偏客户端</td>
</tr>
<tr>
<td>动态化能力</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>渲染性能</td>
<td>差</td>
<td>一般</td>
<td>一般</td>
<td>好</td>
</tr>
<tr>
<td>滑动性能</td>
<td>差</td>
<td>一般</td>
<td>一般</td>
<td>好</td>
</tr>
<tr>
<td>页面级支持</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>区块级支持</td>
<td>不支持</td>
<td>支持</td>
<td>支持</td>
<td>支持</td>
</tr>
<tr>
<td>开发效率</td>
<td>高</td>
<td>一般</td>
<td>一般</td>
<td>一般</td>
</tr>
<tr>
<td>维护成本</td>
<td>低</td>
<td>一般</td>
<td>高</td>
<td>低</td>
</tr>
<tr>
<td>系统升级视频难度</td>
<td>低</td>
<td>中</td>
<td>中</td>
<td>低</td>
</tr>
<tr>
<td>社区生态</td>
<td>活跃</td>
<td>活跃</td>
<td>不活跃</td>
<td>活跃</td>
</tr>
</tbody></table>
<h2 id="Flutter框架介绍"><a href="#Flutter框架介绍" class="headerlink" title="Flutter框架介绍"></a>Flutter框架介绍</h2><p><img src="/2019/08/25/Flutter-UI-Develop/20191115_01.png" alt></p>
<p>Flutter架构采用分层设计，从下到上分为三层，依次为:Embedder、Engine、Framework。</p>
<p>Embedder是操作系统适配层，实现了渲染Surface设置，线程设置，以及平台插件等平台相关特性的适 配。从这里我们可以看到，Flutter平台相关特性并不多，这就使得从框架层面保持跨端一致性的成本相对 较低。</p>
<p>Engine层主要包含Skia、Dart和Text，实现了Flutter的渲染引擎、文字排版、事件处理和Dart运行时等功 能。Skia和Text为上层接口提供了调用底层渲染和排版的能力，Dart则为Flutter提供了运行时调用Dart和 渲染引擎的能力。而Engine层的作用，则是将它们组合起来，从它们生成的数据中实现视图渲染。</p>
<p>Framework层则是一个用Dart实现的UI SDK，包含了动画、图形绘制和手势识别等功能。为了在绘制控 件等固定样式的图形时提供更直观、更方便的接口，Flutter还基于这些基础能力，根据Material和 Cupertino两种视觉设计风格封装了一套UI组件库。我们在开发Flutter的时候，可以直接使用这些组件库。</p>
<h2 id="Flutter是怎么运转的"><a href="#Flutter是怎么运转的" class="headerlink" title="Flutter是怎么运转的?"></a>Flutter是怎么运转的?</h2><p>Flutter和其他跨平台方案的本质区别<br>与用于构建移动应用程序的其他大多数框架不同，Flutter是重写了一整套包括底层渲染逻辑和上层开发语言 的完整解决方案。这样不仅可以保证视图渲染在Android和iOS上的高度一致性(即高保真)，在代码执行 效率和渲染性能上也可以媲美原生App的体验(即高性能)。自己完成了组件渲染的闭环</p>
<p>React Native之类的框架，只是通过JavaScript虚拟机扩展调用系统组件，由Android和iOS系统进行组件 的渲染;</p>
<p>Flutter是怎么完成组件渲染的呢?这需要从图像显示的基本原理说起。</p>
<p>在计算机系统中，图像的显示需要CPU、GPU和显示器一起配合完成:CPU负责图像数据计算，GPU负责图 像数据渲染，而显示器则负责最终图像显示。</p>
<p>CPU把计算好的、需要显示的内容交给GPU，由GPU完成渲染后放入帧缓冲区，随后视频控制器根据垂直同 步信号(VSync)以每秒60次的速度，从帧缓冲区读取帧数据交由显示器完成图像显示。</p>
<p>操作系统在呈现图像时遵循了这种机制，而Flutter作为跨平台开发框架也采用了这种底层方案。</p>
<p><img src="/2019/08/25/Flutter-UI-Develop/20191115_02.png" alt></p>
]]></content>
      <categories>
        <category>技术</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
      </tags>
  </entry>
</search>
